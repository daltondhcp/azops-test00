{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "input": {
      "value": {
        "Name": "c35d7179-67a5-4d06-9b97-5e2daf519ffb",
        "ResourceType": "Microsoft.Authorization/policyDefinitions",
        "Properties": {
          "Description": null,
          "DisplayName": "Deploy-MDE",
          "Metadata": {},
          "Mode": "All",
          "Parameters": {
            "listOfImageIdToInclude": {
              "type": "Array",
              "metadata": {
                "displayName": "Optional: List of virtual machine images that have supported Windows OS to add to scope",
                "description": "Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'"
              },
              "defaultValue": []
            },
            "effect": {
              "type": "String",
              "metadata": {
                "displayName": "Effect",
                "description": "Enable or disable the execution of the policy"
              },
              "allowedValues": [
                "DeployIfNotExists",
                "Disabled"
              ],
              "defaultValue": "DeployIfNotExists"
            }
          },
          "PolicyRule": {
            "if": {
              "allOf": [
                {
                  "field": "type",
                  "equals": "Microsoft.Compute/virtualMachineScaleSets"
                },
                {
                  "anyOf": [
                    {
                      "field": "Microsoft.Compute/imageId",
                      "in": "[parameters('listOfImageIdToInclude')]"
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftWindowsServer"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "WindowsServer"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "in": [
                            "2008-R2-SP1",
                            "2008-R2-SP1-smalldisk",
                            "2012-Datacenter",
                            "2012-Datacenter-smalldisk",
                            "2012-R2-Datacenter",
                            "2012-R2-Datacenter-smalldisk",
                            "2016-Datacenter",
                            "2016-Datacenter-Server-Core",
                            "2016-Datacenter-Server-Core-smalldisk",
                            "2016-Datacenter-smalldisk",
                            "2016-Datacenter-with-Containers",
                            "2016-Datacenter-with-RDSH",
                            "2019-Datacenter",
                            "2019-Datacenter-Core",
                            "2019-Datacenter-Core-smalldisk",
                            "2019-Datacenter-Core-with-Containers",
                            "2019-Datacenter-Core-with-Containers-smalldisk",
                            "2019-Datacenter-smalldisk",
                            "2019-Datacenter-with-Containers",
                            "2019-Datacenter-with-Containers-smalldisk",
                            "2019-Datacenter-zhcn",
                            "2019-datacenter-gensecond"
                          ]
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftWindowsServer"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "WindowsServerSemiAnnual"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "in": [
                            "Datacenter-Core-1709-smalldisk",
                            "Datacenter-Core-1709-with-Containers-smalldisk",
                            "Datacenter-Core-1803-with-Containers-smalldisk"
                          ]
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftWindowsServerHPCPack"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "WindowsServerHPCPack"
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftSQLServer"
                        },
                        {
                          "anyOf": [
                            {
                              "field": "Microsoft.Compute/imageOffer",
                              "like": "*-WS2016"
                            },
                            {
                              "field": "Microsoft.Compute/imageOffer",
                              "like": "*-WS2016-BYOL"
                            },
                            {
                              "field": "Microsoft.Compute/imageOffer",
                              "like": "*-WS2012R2"
                            },
                            {
                              "field": "Microsoft.Compute/imageOffer",
                              "like": "*-WS2012R2-BYOL"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftRServer"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "MLServer-WS2016"
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftVisualStudio"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "in": [
                            "VisualStudio",
                            "Windows"
                          ]
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftDynamicsAX"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "Dynamics"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "equals": "Pre-Req-AX7-Onebox-U8"
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftDynamicsAX"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "Dynamics"
                        },
                        {
                          "field": "Microsoft.Compute/imageSKU",
                          "equals": "Pre-Req-AX7-Onebox-V4"
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "microsoft-ads"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "windows-data-science-vm"
                        }
                      ]
                    },
                    {
                      "allOf": [
                        {
                          "field": "Microsoft.Compute/imagePublisher",
                          "equals": "MicrosoftWindowsDesktop"
                        },
                        {
                          "field": "Microsoft.Compute/imageOffer",
                          "equals": "Windows-10"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "then": {
              "effect": "[parameters('effect')]",
              "details": {
                "type": "Microsoft.Compute/virtualMachineScaleSets/extensions",
                "existenceCondition": {
                  "allOf": [
                    {
                      "field": "Microsoft.Compute/virtualMachineScaleSets/extensions/type",
                      "equals": "Microsoft.Compute.CustomScriptExtension"
                    },
                    {
                      "field": "Microsoft.Compute/virtualMachineScaleSets/extensions/publisher",
                      "equals": "CustomScriptExtension"
                    }
                  ]
                },
                "roleDefinitionIds": [
                  "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
                ],
                "deployment": {
                  "properties": {
                    "mode": "Incremental",
                    "template": {
                      "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                      "contentVersion": "1.0.0.0",
                      "parameters": {
                        "vmName": {
                          "type": "string"
                        }
                      },
                      "variables": {
                        "vmExtensionName": "MDE.Windows",
                        "vmExtensionPublisher": "Microsoft.Azure.AzureDefenderForServers",
                        "vmExtensionType": "MDE.Windows",
                        "vmExtensionTypeHandlerVersion": "1.0"
                      },
                      "resources": [
                        {
                          "type": "Microsoft.Compute/virtualMachineScaleSets/extensions",
                          "apiVersion": "2021-11-01",
                          "name": "[concat(parameters('vmName'), '/', variables('vmExtensionName'))]",
                          "location": "[resourceGroup().location]",
                          "properties": {
                            "autoUpgradeMinorVersion": true,
                            "publisher": "[variables('vmExtensionPublisher')]",
                            "type": "[variables('vmExtensionType')]",
                            "typeHandlerVersion": "[variables('vmExtensionTypeHandlerVersion')]",
                            "settings": {
                              "azureResourceId": "[resourceId('Microsoft.Compute/virtualMachineScaleSets', parameters('vmName'))]"
                            },
                            "protectedSettings": {
                              "defenderForEndpointOnboardingScript": "QGVjaG8gb2ZmDQoNCmVjaG8uID5OVUwgMj4mMQ0KZWNobyBTdGFydGluZyBNaWNyb3NvZnQgRGVmZW5kZXIgZm9yIEVuZHBvaW50IG9uYm9hcmRpbmcgcHJvY2Vzcy4uLiA+TlVMIDI+JjENCmVjaG8uID5OVUwgMj4mMQ0KDQpzZXQgZXJyb3JDb2RlPTANCnNldCBsYXN0RXJyb3I9MA0Kc2V0ICJ0cm91Ymxlc2hvb3RJbmZvPUZvciBtb3JlIGluZm9ybWF0aW9uLCB2aXNpdDogaHR0cHM6Ly9nby5taWNyb3NvZnQuY29tL2Z3bGluay9wLz9saW5raWQ9ODIyODA3Ig0Kc2V0ICJlcnJvckRlc2NyaXB0aW9uPSINCg0KZWNobyBUZXN0aW5nIGFkbWluaXN0cmF0b3IgcHJpdmlsZWdlcyA+TlVMIDI+JjENCg0KbmV0IHNlc3Npb24gPk5VTCAyPiYxDQppZiAlRVJST1JMRVZFTCUgTkVRIDAgKA0KCUBlY2hvIFNjcmlwdCBpcyBydW5uaW5nIHdpdGggaW5zdWZmaWNpZW50IHByaXZpbGVnZXMuIFBsZWFzZSBydW4gd2l0aCBhZG1pbmlzdHJhdG9yIHByaXZpbGVnZXM+ICVUTVAlXHNlbnNlVG1wLnR4dA0KCXNldCBlcnJvckNvZGU9NjUNCiBzZXQgbGFzdEVycm9yPSVFUlJPUkxFVkVMJQ0KCUdPVE8gRVJST1INCikNCg0KZWNobyBTY3JpcHQgaXMgcnVubmluZyB3aXRoIHN1ZmZpY2llbnQgcHJpdmlsZWdlcyA+TlVMIDI+JjENCmVjaG8uID5OVUwgMj4mMQ0KZWNobyBQZXJmb3JtaW5nIG9uYm9hcmRpbmcgb3BlcmF0aW9ucyA+TlVMIDI+JjENCmVjaG8uID5OVUwgMj4mMQ0KCklGIFslUFJPQ0VTU09SX0FSQ0hJVEVXNjQzMiVdIEVRVSBbXSAoDQogIHNldCBwb3dlcnNoZWxsUGF0aD0ld2luZGlyJVxTeXN0ZW0zMlxXaW5kb3dzUG93ZXJTaGVsbFx2MS4wXHBvd2Vyc2hlbGwuZXhlDQopIEVMU0UgKA0KICBzZXQgcG93ZXJzaGVsbFBhdGg9JXdpbmRpciVcU3lzTmF0aXZlXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBccG93ZXJzaGVsbC5leGUNCikNCgpzZXQgc2RiaW49MDEwMDA0ODA0NDAwMDAwMDU0MDAwMDAwMDAwMDAwMDAxNDAwMDAwMDAyMDAzMDAwMDIwMDAwMDAwMDAwMTQwMEZGMEYxMjAwMDEwMTAwMDAwMDAwMDAwNTEyMDAwMDAwMDAwMDE0MDBFMTA0MTIwMDAxMDEwMDAwMDAwMDAwMDUwQjAwMDAwMDAxMDIwMDAwMDAwMDAwMDUyMDAwMDAwMDIwMDIwMDAwMDEwMjAwMDAwMDAwMDAwNTIwMDAwMDAwMjAwMjAwMDAgPk5VTCAyPiYxDQpyZWcgYWRkIEhLTE1cU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcV01JXFNlY3VyaXR5IC92IDE0ZjgxMzhlLTNiNjEtNTgwYi01NDRiLTI2MDkzNzhhZTQ2MCAvdCBSRUdfQklOQVJZIC9kICVzZGJpbiUgL2YgPk5VTCAyPiYxDQpyZWcgYWRkIEhLTE1cU1lTVEVNXEN1cnJlbnRDb250cm9sU2V0XENvbnRyb2xcV01JXFNlY3VyaXR5IC92IGNiMmZmNzJkLWQ0ZTQtNTg1ZC0zM2Y5LWYzYTM5NWM0MGJlNyAvdCBSRUdfQklOQVJZIC9kICVzZGJpbiUgL2YgPk5VTCAyPiYxDQoKUkVHIGFkZCAiSEtMTVxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93c1xEYXRhQ29sbGVjdGlvbiIgL3YgRGlzYWJsZUVudGVycHJpc2VBdXRoUHJveHkgL3QgUkVHX0RXT1JEIC9mIC9kIDEgPk5VTCAyPiYxDQoKJXBvd2Vyc2hlbGxQYXRoJSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtTm9Qcm9maWxlIC1Db21tYW5kICJBZGQtVHlwZSAnIHVzaW5nIFN5c3RlbTsgdXNpbmcgU3lzdGVtLklPOyB1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7IHVzaW5nIE1pY3Jvc29mdC5XaW4zMi5TYWZlSGFuZGxlczsgdXNpbmcgU3lzdGVtLkNvbXBvbmVudE1vZGVsOyBwdWJsaWMgc3RhdGljIGNsYXNzIEVsYW17IFtEbGxJbXBvcnQoXCJLZXJuZWwzMlwiLCBDaGFyU2V0PUNoYXJTZXQuQXV0bywgU2V0TGFzdEVycm9yPXRydWUpXSBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIEluc3RhbGxFTEFNQ2VydGlmaWNhdGVJbmZvKFNhZmVGaWxlSGFuZGxlIGhhbmRsZSk7IHB1YmxpYyBzdGF0aWMgdm9pZCBJbnN0YWxsV2RCb290KHN0cmluZyBwYXRoKSB7IENvbnNvbGUuT3V0LldyaXRlTGluZShcIkFib3V0IHRvIGNhbGwgY3JlYXRlIGZpbGUgb24gezB9XCIsIHBhdGgpOyB2YXIgc3RyZWFtID0gRmlsZS5PcGVuKHBhdGgsIEZpbGVNb2RlLk9wZW4sIEZpbGVBY2Nlc3MuUmVhZCwgRmlsZVNoYXJlLlJlYWQpOyB2YXIgaGFuZGxlID0gc3RyZWFtLlNhZmVGaWxlSGFuZGxlOyBDb25zb2xlLk91dC5Xcml0ZUxpbmUoXCJBYm91dCB0byBjYWxsIEluc3RhbGxFTEFNQ2VydGlmaWNhdGVJbmZvIG9uIGhhbmRsZSB7MH1cIiwgaGFuZGxlLkRhbmdlcm91c0dldEhhbmRsZSgpKTsgaWYgKCFJbnN0YWxsRUxBTUNlcnRpZmljYXRlSW5mbyhoYW5kbGUpKSB7IENvbnNvbGUuT3V0LldyaXRlTGluZShcIkNhbGwgZmFpbGVkLlwiKTsgdGhyb3cgbmV3IFdpbjMyRXhjZXB0aW9uKE1hcnNoYWwuR2V0TGFzdFdpbjMyRXJyb3IoKSk7IH0gQ29uc29sZS5PdXQuV3JpdGVMaW5lKFwiQ2FsbCBzdWNjZXNzZnVsLlwiKTsgfSB9ICc7ICRkcml2ZXJQYXRoID0gJGVudjpTeXN0ZW1Sb290ICsgJ1xTeXN0ZW0zMlxEcml2ZXJzXFdkQm9vdC5zeXMnOyBbRWxhbV06Okluc3RhbGxXZEJvb3QoJGRyaXZlclBhdGgpICIgPk5VTCAyPiYxDQoKUkVHIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXFBvbGljaWVzXE1pY3Jvc29mdFxXaW5kb3dzIEFkdmFuY2VkIFRocmVhdCBQcm90ZWN0aW9uIiAvdiA2OTZDMUZBMS00MDMwLTRGQTQtODcxMy1GQUY5QjJFQTdDMEEgL3JlZzo2NCA+ICVUTVAlXHNlbnNlVG1wLnR4dCAyPiYxDQppZiAlRVJST1JMRVZFTCUgRVFVIDAgKCAgDQogICAgUkVHIGRlbGV0ZSAiSEtMTVxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93cyBBZHZhbmNlZCBUaHJlYXQgUHJvdGVjdGlvbiIgL3YgNjk2QzFGQTEtNDAzMC00RkE0LTg3MTMtRkFGOUIyRUE3QzBBIC9mID4gJVRNUCVcc2Vuc2VUbXAudHh0IDI+JjENCiAgICBpZiAlRVJST1JMRVZFTCUgTkVRIDAgKA0KICAgICAgICBzZXQgImVycm9yRGVzY3JpcHRpb249VW5hYmxlIHRvIGRlbGV0ZSBwcmV2aW91cyBvZmZib2FyZGluZyBpbmZvcm1hdGlvbiBmcm9tIHJlZ2lzdHJ5LiINCiAgICAgICAgc2V0IGVycm9yQ29kZT01DQogICAgICAgIHNldCBsYXN0RXJyb3I9JUVSUk9STEVWRUwlDQogICAgICAgIEdPVE8gRVJST1INCiAgICApDQopDQoKUkVHIGFkZCAiSEtMTVxTT0ZUV0FSRVxQb2xpY2llc1xNaWNyb3NvZnRcV2luZG93cyBBZHZhbmNlZCBUaHJlYXQgUHJvdGVjdGlvbiIgL3YgT25ib2FyZGluZ0luZm8gL3QgUkVHX1NaIC9mIC9kICJ7XCJib2R5XCI6XCJ7XFxcInByZXZpb3VzT3JnSWRzXFxcIjpbXSxcXFwib3JnSWRcXFwiOlxcXCI4MGQ3NDhlYi0zZmI0LTRmMzktOGZiMy05NjRjYTc0NmQwMzBcXFwiLFxcXCJnZW9Mb2NhdGlvblVybFxcXCI6XFxcImh0dHBzOi8vd2luYXRwLWd3LXdldS5taWNyb3NvZnQuY29tL1xcXCIsXFxcImRhdGFjZW50ZXJcXFwiOlxcXCJXZXN0RXVyb3BlXFxcIixcXFwidm9ydGV4R2VvTG9jYXRpb25cXFwiOlxcXCJFVVxcXCIsXFxcInZlcnNpb25cXFwiOlxcXCIxLjM1XFxcIn1cIixcInNpZ1wiOlwiOWhPcnh5VS9iZTZhNlNQQjBDYVpGSXZIUXQwQzQ1VTdYVFpJaW9OeVNHamdOZHJ3RHlITi81bExZYVBsZ1NmVDlwem9PcGxYVE1JVDRYcCsvMjJGd2lnbVJsbktzMTVJbk9rRFZDcDhhUnhGVGtvNE1xbFIyZXJUZlRESVYyQk9BUnJvc0ZrZE40Y2J0V1lRZGZ1bEpnTVE1WG1lalpOd3Erdy9kcmo5cGNFQTBlSE9wWXREZUFCdjd4TkZzVFpESUt5RVRINGJiVkFMV2JtbEFBcys2d0p0Ynhub2QxV05kWUQxY3pZZWhXUHZYNkVKMnBURGwyRU9vaUNOMjlsMjdseWVjREhFbjhQbzFGL0RpUStVdEoxZVZQOWZIQjhoTGs5K1gvL2F6b0NLSTRtam1BZTgyQnpZNmVuQTNCaDhUV1c0SHFncERZbEQ5c0tNb24yZEZRPT1cIixcInNoYTI1NnNpZ1wiOlwiZnVObHVaYUh0VzhiUCtKcktoUmJXU3QrZE9wRGJmSVFIeUJkUE5BNlFEb2JrTlFQdENsOGtuOExaU1Z3SEZQaVo5Wm9YU3U3NVkxZGNZMXI0cG9EemtCQmVGL0JsMmI1aGgzbWFKcGFZa3hZOUd2RmdQV1N5MzBsL0laNzJCMjNyT2tNdWkzaWFNSGlXTmFXWmQvR2tJcngzTjBWcnpPaHdpNmJDZHl6bmh4TGtzeUZKUEFyQjNWQkVmVERQbFpsVnloTytuamFDNEVhVG1GYURVWnNKajNFQVVERW1ZUHJsYU9wRit2S2pEZkZaUEJtbVBtZm5HS3ZvUC9KcTczcXZpbGF6dXh5dCtmcFc0U2JQZE13RmpCYzFWUlNNRG5FUXBIbjFCU2lxc0dmUjk0UVlwbWRFNDlSaXAxUS93WU1BYzFvb3ZBQS8vaFIwUVEreUMraFlBPT1cIixcImNlcnRcIjpcIk1JSUZnekNDQTJ1Z0F3SUJBZ0lUTXdBQUFibnZhYTNCdGREaXlRQUFBQUFCdVRBTkJna3Foa2lHOXcwQkFRc0ZBREIrTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtWMkZ6YUdsdVozUnZiakVRTUE0R0ExVUVCeE1IVW1Wa2JXOXVaREVlTUJ3R0ExVUVDaE1WVFdsamNtOXpiMlowSUVOdmNuQnZjbUYwYVc5dU1TZ3dKZ1lEVlFRREV4OU5hV055YjNOdlpuUWdVMlZqZFhKbElGTmxjblpsY2lCRFFTQXlNREV4TUI0WERUSXhNRGN3TVRFNU1UUTBPRm9YRFRJeU1EY3dNVEU1TVRRME9Gb3dIakVjTUJvR0ExVUVBeE1UVTJWMmFXeHNaUzVYYVc1a2IzZHpMbU52YlRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTndRcW1Rbmg4elBBV3NJcVQ5dzhmTy9pc25MaklxN3hHcVNCR0pkODVHWlJDMlBTL2hISkV0eExoS2JsekJpUHd1OU1BRWtEeDZ5cCt1RHBmMWhNa0lZRG80N0QvUjY3ZnZBY1EwVEo4MlRkQnM4YnlZQnNJc3l1bGYxNlR3NlFNeVpzc2FEZDdXOXdGYzFwVG1CNjBCNnlieDlCVmNHeEhlNUhNek5mbVdwY0MvK2psOURacEpUQUpQalBHbXc0SkJlMnVUa3gvTTNrZm9oV2pENnZUekxDRHRGR1UrWXZLOW4vVGt5OEFZeTdpT2ZsZmY0SHNxclFmc2p2TFBCNEVxZjVESDZkZCtPcGZTY3BtcFdxMjNHVFZ3WU1MSVZ0a2dHM3B6V1M2R3QxZjd3eEZqcFYwcUZLaXgvUk9RK1FxY3NYaXN5bU1kTEVQMDdtaFlwZVZFQ0F3RUFBYU9DQVZnd2dnRlVNQTRHQTFVZER3RUIvd1FFQXdJRklEQWRCZ05WSFNVRUZqQVVCZ2dyQmdFRkJRY0RBUVlJS3dZQkJRVUhBd0l3REFZRFZSMFRBUUgvQkFJd0FEQWVCZ05WSFJFRUZ6QVZnaE5UWlhacGJHeGxMbGRwYm1SdmQzTXVZMjl0TUIwR0ExVWREZ1FXQkJSaVNyM1lTWjI5VUg3Z2lYNm9FS3FPVW5mODVqQWZCZ05WSFNNRUdEQVdnQlEyVm9sbFNjdGJteTg4ckVJV1VFMlJ1VFBYa1RCVEJnTlZIUjhFVERCS01FaWdScUJFaGtKb2RIUndPaTh2ZDNkM0xtMXBZM0p2YzI5bWRDNWpiMjB2Y0d0cGIzQnpMMk55YkM5TmFXTlRaV05UWlhKRFFUSXdNVEZmTWpBeE1TMHhNQzB4T0M1amNtd3dZQVlJS3dZQkJRVUhBUUVFVkRCU01GQUdDQ3NHQVFVRkJ6QUNoa1JvZEhSd09pOHZkM2QzTG0xcFkzSnZjMjltZEM1amIyMHZjR3RwYjNCekwyTmxjblJ6TDAxcFkxTmxZMU5sY2tOQk1qQXhNVjh5TURFeExURXdMVEU0TG1OeWREQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FnRUFOc2VSQXNyZC8zTEJLR0FSOVBPNFFHOXFYTXJZY3NQTW1BcnVaR1dlMmhMQlZkajVWcTVSYURzK1BVaXNTMDhKZjVra1FCTFJpd3gwNjFhNFU5WXJvYk5WZFAvRlVqd3E4VUpTSHhXVnIzZXJWU2F6T3FDWStaT1lSUWdCSkJ0emk0bmhLVi9MMCtHOHV4ai9yMnlpSEJ1UWVXSEkvZWVYT2QrL2J3LzNCa2RVVGdFTnJydG00ZlhhbnVIeWFTSGovcStnNGVhL2Nxck91RCtpSWIrZ2FLTS81ZThwV0owTWNGM2RZd1V2QmNIMEZmeEtqZWdLcnNDQlUrWStCbUVpcjhORUhYTjdaVVZHeDFCaVc1RE9CamdqQ3FZbzV1eEU0Ynp0TW1pamI1Y3VIM0diUVhQbWZHbTdHS0JOK1M3enlBK3FLNHhhblM0Y0NxYVZ2WnBJWVhvUHk0Q1RHWHljdHlBRkxEVHlia2N4dVhVMlVxRCtrNDNVa3JUcGd2WmZ6QXUwWGVXa2NtTmZIc3VKT3ArWUEzQnhxMURVQXRkdk53RStvUTBMUWhqdnFoekU5K25UeWtYRlFxNW1WWmxYWU0zRy9ZM2xHeXhETXFmeUVBRm5UK25ZTGJSaG5rTjZOaWRoZmU5TUtSTlN1MmpLemZrbVlvSUdJYVdXL2JkN1duQ0RkNzVEaElnc0NXOUxIQWlrYVQyamIrSmlQOVIxZ3JzWTNrZjk4ZzlLTzJnSVFLTnlpZmlWWXJaUW4wMndYVmZyRWgyUWVsdm9tNGxCRVJyVTNCL1c1bW1waDRVRjNYM2lVNWxDdjU1T2NvSFUyRlk0RXVzblFveEFtQk1SejZ5eHhIWnFWdWM4SVczRzhqeHVOdTBIYUI5dloraU1Fa2Q5c0VJZk1wQT1cIixcImNoYWluXCI6W1wiTUlJRzJEQ0NCTUNnQXdJQkFnSUtZVCszR0FBQUFBQUFCREFOQmdrcWhraUc5dzBCQVFzRkFEQ0JpREVMTUFrR0ExVUVCaE1DVlZNeEV6QVJCZ05WQkFnVENsZGhjMmhwYm1kMGIyNHhFREFPQmdOVkJBY1RCMUpsWkcxdmJtUXhIakFjQmdOVkJBb1RGVTFwWTNKdmMyOW1kQ0JEYjNKd2IzSmhkR2x2YmpFeU1EQUdBMVVFQXhNcFRXbGpjbTl6YjJaMElGSnZiM1FnUTJWeWRHbG1hV05oZEdVZ1FYVjBhRzl5YVhSNUlESXdNVEV3SGhjTk1URXhNREU0TWpJMU5URTVXaGNOTWpZeE1ERTRNak13TlRFNVdqQitNUXN3Q1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1YyRnphR2x1WjNSdmJqRVFNQTRHQTFVRUJ4TUhVbVZrYlc5dVpERWVNQndHQTFVRUNoTVZUV2xqY205emIyWjBJRU52Y25CdmNtRjBhVzl1TVNnd0pnWURWUVFERXg5TmFXTnliM052Wm5RZ1UyVmpkWEpsSUZObGNuWmxjaUJEUVNBeU1ERXhNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQTBBdkFwS2daZ2VJMjVlS3E1Zk95RlZoMXZyVGxTZkhnaFBtN0RXVHZoY0dCVmJqejUvRnRRRlU5em90cTBZU1Q5WFY4VzZUVWRCREtNdk1qMDY3dXo1NEVXTUxaUjh2UmZBQkJTSEViQVdjWEdLL0cvbk1EZnVUdlE1enZBWEVxSDRFbVEzZVlWRmR6blZVcjhKNk9mUVlPckJ0VTh5YjMrQ01JSW91ZUJoMDNPUDF5MHNybFk4R2FXbjJ5YmJOU3FXN3Byclg4aXpiNW52cjJIRmdibDFhbEVlVzNVdHU3NmZCVXY3VC9MR3k0WFNiT29BclgzNVB0ZjkyczhTeHpHdGtaTjFXNjNTSjRqcUhVbXduNEJ5SXhjYkNVcnVDdzV5WkVWNUNCbHhYT1lleGw0a3Z4aFZJV012aTFlS3ArelUzc2d5R2txSnUrbW1vRTRLTWN6VllZYlAxckwwSSs0amZ5Y3F2UWVITnllOTdzQUZqbElUQ2pDRHFaNzUvRDkzb1dsbVcxdzRHdjlEbHdTYS8ycWZacUFEajV0QWdaNEJvMXBWWjJJbDlxOG1tdVBxMVlSazI0VlBhSlFVUWVjckc4RWlkVDBzSC9zczFRbUI2MTlMdTJ3b0k1MmF3Yjhqc25oR3F3eGlZTDF6b1E1N1BiZk5OV3JGTk1DL283TVRkMDJGa3IrUUI1R1FaNy9Sd2RRdFJCRFM4RkR0VnJTU1AvejgzNGVvTFAyand0MytqWUVnUVl1aDZJZDdpWUh4QUh1OGdGZmdzSnYydmQ0MDVic1BuSGhLWTd5a3lmVzJJcDk4ZWlxSldJY0N6bHdUODhVaU5QUUpyRE1ZV0RMNzhwOFIxUWp5R1dCODd2OG9EQ1JIMmJZdTh2dzNlSnEwVk5VejRDZWRNQ0F3RUFBYU9DQVVzd2dnRkhNQkFHQ1NzR0FRUUJnamNWQVFRREFnRUFNQjBHQTFVZERnUVdCQlEyVm9sbFNjdGJteTg4ckVJV1VFMlJ1VFBYa1RBWkJna3JCZ0VFQVlJM0ZBSUVEQjRLQUZNQWRRQmlBRU1BUVRBTEJnTlZIUThFQkFNQ0FZWXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QWZCZ05WSFNNRUdEQVdnQlJ5TFRvQ01aQkR1UlFGVHVIcXA4Y3gwU09KTkRCYUJnTlZIUjhFVXpCUk1FK2dUYUJMaGtsb2RIUndPaTh2WTNKc0xtMXBZM0p2YzI5bWRDNWpiMjB2Y0d0cEwyTnliQzl3Y205a2RXTjBjeTlOYVdOU2IyOURaWEpCZFhReU1ERXhYekl3TVRGZk1ETmZNakl1WTNKc01GNEdDQ3NHQVFVRkJ3RUJCRkl3VURCT0JnZ3JCZ0VGQlFjd0FvWkNhSFIwY0RvdkwzZDNkeTV0YVdOeWIzTnZablF1WTI5dEwzQnJhUzlqWlhKMGN5OU5hV05TYjI5RFpYSkJkWFF5TURFeFh6SXdNVEZmTUROZk1qSXVZM0owTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElDQVFCQnlHSEI5VnVlUHBFeDhiREd2d2tCdEoyMmtIVFhDZHVtTGcyZnlPZDJORWF2QjJDSlRJR3pQTlgwRWpWMXduT2w5VTJFak11a1hhKy9rdllYQ0ZkQ2xYSmxCWFo1cmU3UnVyZ3VWS05SQjZ4bzZ5RU00eVdCd3MwcThzUC96OEs5U1JpYXgvQ0V4ZmtVdkd1VjVaYnZzMExTVTlWS29CTEVyaEoyVXdsV0RwMzMwNlpKaUZEeWlpeVhJS0srVG5qdkJXVzNTNkVXaU40eHh3aENKSHlrZTU2ZHZHQUFYbUtYNDVQOHAvNWJleVhmNUZOL1M3N21QdkRiQVhsQ0hHNkZiSDIyUkREN3BUZVNrN0tsN2lDdFAxUFZ5ZlFvYTFmQitCMXF0MVlxdGllQkhLWXRuK2YwMERHRGw2Z3F0cXkrRzBIMTVJbGZWdnZhV3ROZWZWV1VFSDVUVi9SS1BVQXF5TDFubjRUaEVPNzkybXNWZ2tuOFJoMy9SUVowbkVJVTdjVTUwN1BOQzRNbmtFTlJrdkpFZ3E1dW1oVVhzaG42eDBWc21BRjd2emVwc0lpa2tydzRPT0FkNUh5WG1Cb3VYKzg0WmJjMUw3MS9UeUg2eEl6U2J3YjVTVFhxM3lBUEphcnFZS3NzSDB1Si9MZjZYRlNRU3o2aUtFOXM1Rkpsd2YyUUhJV0NpRzdwcGxYZElTaDVSYkFVNVFyTTVsL0V1OXRoTkdtZnJDWTQ5OEVwUVFnVkxreWc5L2tNUHQ1ZnF3Z0pMWU9zckRTRFl2VEpTVUtKSmJWdXNrZkZzem1nc1NBYkxMR09CRytsTUVrYzBFYnBRRnYwclc2NjI0SktoeEpLZ0FsTjI5OTJ1UVZiRytDN0lIQmZBQ1hIMHc3NkZxMTdJcDV4Q0E9PVwiLFwiTUlJRjdUQ0NBOVdnQXdJQkFnSVFQNHZJdGZ5ZnNwWkR0V25XYkVMaFJEQU5CZ2txaGtpRzl3MEJBUXNGQURDQmlERUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlZCQWdUQ2xkaGMyaHBibWQwYjI0eEVEQU9CZ05WQkFjVEIxSmxaRzF2Ym1ReEhqQWNCZ05WQkFvVEZVMXBZM0p2YzI5bWRDQkRiM0p3YjNKaGRHbHZiakV5TURBR0ExVUVBeE1wVFdsamNtOXpiMlowSUZKdmIzUWdRMlZ5ZEdsbWFXTmhkR1VnUVhWMGFHOXlhWFI1SURJd01URXdIaGNOTVRFd016SXlNakl3TlRJNFdoY05Nell3TXpJeU1qSXhNekEwV2pDQmlERUxNQWtHQTFVRUJoTUNWVk14RXpBUkJnTlZCQWdUQ2xkaGMyaHBibWQwYjI0eEVEQU9CZ05WQkFjVEIxSmxaRzF2Ym1ReEhqQWNCZ05WQkFvVEZVMXBZM0p2YzI5bWRDQkRiM0p3YjNKaGRHbHZiakV5TURBR0ExVUVBeE1wVFdsamNtOXpiMlowSUZKdmIzUWdRMlZ5ZEdsbWFXTmhkR1VnUVhWMGFHOXlhWFI1SURJd01URXdnZ0lpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElDRHdBd2dnSUtBb0lDQVFDeWdFR3FOVGhORTNJeWFDSk51TEx4LzlWU3ZHekg5ZEpLakRidTBjSmNmb3lLcnE4VEtHL0FjK002enRBbHFGbzZiZStvdUZtckV5Tm96UXdwaDlGdmdGeVBSSDlka0FGU1dLeFJ4VjhxaDl6YzJBb2R3UU81ZTdCVzZLUGVaR0hDbnZqemZMbnNEYlZVL2t5MlpVK0k4SnhJbVF4Q0N3bDhNVmtYZVFaNEtJMkpPa3dESmI1eGFsd0w1NFJncEpraTQ5S3ZoS1NuKzlHWTdReXAzcFNKNFE2ZzNNRE9tVDNxQ0ZLN1ZubmtINFM2SHJpMHhFbGNUekZMaDkzZEJXY21tWURnY1JHanVLVkI0cVJUdWZjeUtZTU1FNzgyWGdTelMwTkhMMnZpa1I3VG1FL2RRZ2ZJNkIwUy9KbXBhejZTZnNqV2FUcjhaTDIyQ1ozSy9Rd0xvcHQzWUVzRGxLUXdhUkxXUWkzQlFVekszS3I5ajF1RFJwclovTEhSNDdQSmYwaDZ6U1R3UVk5Y2ROQ3NzQkFnQmttM3h5MGh5RmZqMEliekEyajcwTTV4d1ltWlNtUUJiUDNzTUpIUFFUeVN4K1c2aGgxaGhNZGZnemxpcnJTU0wwZnpDL2hWNjZBZldkQzdkSnNlMEhibTh1a0cxeERvK21UZWFjWTFsb2dDOEVhNFB5ZVpiOHR4aVNrMTkwZ1dBaldQMVhsOFRRTFBYK3VLZzA5RmNZajVxUTFPY3VuQ25BZlBTUnRPQkE1alVZeGUyQURCVlN5Mnh1RENaVTdKTkRuMW5MUEVmdWhoYmhOZkZjUmYyWDd0SGM3dVJPekxMb2F4N0RqMmNPMnJYQlBCMlE4Tng0Q3lWZTAwOTZ5YjVNUGE1MGM4cHJXUE1kL0ZTNi9yOFFJREFRQUJvMUV3VHpBTEJnTlZIUThFQkFNQ0FZWXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QWRCZ05WSFE0RUZnUVVjaTA2QWpHUVE3a1VCVTdoNnFmSE1kRWppVFF3RUFZSkt3WUJCQUdDTnhVQkJBTUNBUUF3RFFZSktvWklodmNOQVFFTEJRQURnZ0lCQUg5eXp3KzN4UlhibThCSnlpWmIvcDRUNXRQdzB0dVhYL0pMUDAyenJobXU3ZGVYb0t6dnFUcWp3a0d3NWJpUm5oT0JKQVBtQ2YwL1YwQTVJU1JXMFJBdlMwQ3BOb1pMdEZOWG12dnhmb21QRWY0WWJGR3E2TzBKbGJYbGNjbWg2WWQxcGhWL3lYNDNWRjUwazhYRFo4d05UMnVvRnd4dENKSitpOTJCcWkxd0ljTTlCaFM3dnlSZXA0VFhQdzhoSXIxTEFBYmJseHpZWHRURkMxeUhibENrNk1NNHBQdkxMTVdTWnB1RlhzdDZiSk44Z0NsWVcxZTFRR202Q0htbVpHSVZuWWVXUmJWbUl5QURpeHh6b05PaWVUUGdVRm1HMnkvbEFpWHFjeXFmQUJUSU5zZVNPK2xPQU96WVZnbTVNMGtTMGxRTEFhdXNSN2FSS1gxTXRIV0FVZ0hveW9MMm44eXNuSThYNmk4bXNLdHlyQXYrbmxFZXgwTlZaMDlSczFmV3R1enVVcmM2NlU3aDE0R0l2RStPZGJ0THFQQTFxaWJVWjJkSnNuQk1PNVBjSGQ5NGtJWnlzamlrMGR5U1RjbFk2eXNTWE5RN3JveHJzSVBsQVQvNENUTDJrelUwSXEvZE53MTNDWUFyelVnQThZeVpHVWNGQWVuUnY5Rk8wT1lvUXplWnBBcEtDTm1hY1hQU3FzMHhFMk4yb1RkdmtqZ2VmUkk4WmpMbnkyM2gvRktKM2NyV1pnV2FsbUcrb2lqSEhLT25ObEE4T3FUZlNtN21oenZPNi9EZ2dUZWRFenhTanIyNUhUVEdIZFVLYWoyWUtYQ01pU3JScTRJUVNCL2M5TytseGJ0VkdqaGpoRTYzYksyVlZPeGxJaEJKRjdqQUhzY1ByRlJIXCJdfSIgPiAlVE1QJVxzZW5zZVRtcC50eHQgMj4mMQppZiAlRVJST1JMRVZFTCUgTkVRIDAgKA0KICAgc2V0ICJlcnJvckRlc2NyaXB0aW9uPVVuYWJsZSB0byB3cml0ZSBvbmJvYXJkaW5nIGluZm9ybWF0aW9uIHRvIHJlZ2lzdHJ5LiINCiAgIHNldCBlcnJvckNvZGU9MTANCiAgIHNldCBsYXN0RXJyb3I9JUVSUk9STEVWRUwlDQogICBHT1RPIEVSUk9SDQopCgplY2hvIFN0YXJ0aW5nIHRoZSBzZXJ2aWNlLCBpZiBub3QgYWxyZWFkeSBydW5uaW5nID5OVUwgMj4mMQ0KZWNoby4gPk5VTCAyPiYxDQpzYyBxdWVyeSAiU0VOU0UiIHwgZmluZCAvaSAiUlVOTklORyIgPk5VTCAyPiYxDQppZiAlRVJST1JMRVZFTCUgRVFVIDAgR09UTyBSVU5OSU5HDQoNCm5ldCBzdGFydCBzZW5zZSA+ICVUTVAlXHNlbnNlVG1wLnR4dCAyPiYxDQppZiAlRVJST1JMRVZFTCUgTkVRIDAgKA0KICAgZWNobyBNaWNyb3NvZnQgRGVmZW5kZXIgZm9yIEVuZHBvaW50IFNlcnZpY2UgaGFzIG5vdCBzdGFydGVkIHlldCA+TlVMIDI+JjENCiAgIEdPVE8gV0FJVF9GT1JfVEhFX1NFUlZJQ0VfVE9fU1RBUlQNCikNCmdvdG8gU1VDQ0VFREVEDQoNCjpSVU5OSU5HDQpzZXQgInJ1bm5pbmdPdXRwdXQ9VGhlIE1pY3Jvc29mdCBEZWZlbmRlciBmb3IgRW5kcG9pbnQgU2VydmljZSBpcyBhbHJlYWR5IHJ1bm5pbmchIg0KZWNobyAlcnVubmluZ091dHB1dCUgPk5VTCAyPiYxDQplY2hvLiA+TlVMIDI+JjENCmV2ZW50Y3JlYXRlIC9sIEFwcGxpY2F0aW9uIC9zbyBXREFUUE9uYm9hcmRpbmcgL3QgSW5mb3JtYXRpb24gL2lkIDEwIC9kICIlcnVubmluZ091dHB1dCUiID5OVUwgMj4mMQ0KR09UTyBXQUlUX0ZPUl9USEVfU0VSVklDRV9UT19TVEFSVA0KDQo6RVJST1INClNldCAvUCBlcnJvck1zZz08JVRNUCVcc2Vuc2VUbXAudHh0DQpzZXQgImVycm9yT3V0cHV0PVtFcnJvciBJZDogJWVycm9yQ29kZSUsIEVycm9yIExldmVsOiAlbGFzdEVycm9yJV0gJWVycm9yRGVzY3JpcHRpb24lIEVycm9yIG1lc3NhZ2U6ICVlcnJvck1zZyUiDQolcG93ZXJzaGVsbFBhdGglIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1Ob1Byb2ZpbGUgLUNvbW1hbmQgIkFkZC1UeXBlICd1c2luZyBTeXN0ZW07IHVzaW5nIFN5c3RlbS5EaWFnbm9zdGljczsgdXNpbmcgU3lzdGVtLkRpYWdub3N0aWNzLlRyYWNpbmc7IG5hbWVzcGFjZSBTZW5zZSB7IFtFdmVudERhdGEoTmFtZSA9IFwiT25ib2FyZGluZ1wiKV1wdWJsaWMgc3RydWN0IE9uYm9hcmRpbmd7cHVibGljIHN0cmluZyBNZXNzYWdlIHsgZ2V0OyBzZXQ7IH19IHB1YmxpYyBjbGFzcyBUcmFjZSB7cHVibGljIHN0YXRpYyBFdmVudFNvdXJjZU9wdGlvbnMgVGVsZW1ldHJ5Q3JpdGljYWxPcHRpb24gPSBuZXcgRXZlbnRTb3VyY2VPcHRpb25zKCl7TGV2ZWwgPSBFdmVudExldmVsLkVycm9yLCBLZXl3b3JkcyA9IChFdmVudEtleXdvcmRzKTB4MDAwMDIwMDAwMDAwMDAwMCwgVGFncyA9IChFdmVudFRhZ3MpMHgwMjAwMDAwfTsgcHVibGljIHZvaWQgV3JpdGVPbmJvYXJkaW5nTWVzc2FnZShzdHJpbmcgbWVzc2FnZSl7ZXMuV3JpdGUoXCJPbmJvYXJkaW5nU2NyaXB0XCIsIFRlbGVtZXRyeUNyaXRpY2FsT3B0aW9uLCBuZXcgT25ib2FyZGluZyB7TWVzc2FnZSA9IG1lc3NhZ2V9KTt9IHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IHN0cmluZ1tdIHRlbGVtZXRyeVRyYWl0cyA9IHsgXCJFVFdfR1JPVVBcIiwgXCJ7NUVDQjBCQUMtQjkzMC00N0Y1LUE4QTQtRTgyNTM1MjlFREI3fVwiIH07IHByaXZhdGUgRXZlbnRTb3VyY2UgZXMgPSBuZXcgRXZlbnRTb3VyY2UoXCJNaWNyb3NvZnQuV2luZG93cy5TZW5zZS5DbGllbnQuTWFuYWdlbWVudFwiLEV2ZW50U291cmNlU2V0dGluZ3MuRXR3U2VsZkRlc2NyaWJpbmdFdmVudEZvcm1hdCx0ZWxlbWV0cnlUcmFpdHMpO319JzsgJGxvZ2dlciA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFNlbnNlLlRyYWNlOyAkbG9nZ2VyLldyaXRlT25ib2FyZGluZ01lc3NhZ2UoJyVlcnJvck91dHB1dCUnKSIgPk5VTCAyPiYxDQplY2hvICVlcnJvck91dHB1dCUgPk5VTCAyPiYxDQplY2hvLiA+TlVMIDI+JjENCmV2ZW50Y3JlYXRlIC9sIEFwcGxpY2F0aW9uIC9zbyBXREFUUE9uYm9hcmRpbmcgL3QgRXJyb3IgL2lkICVlcnJvckNvZGUlIC9kICIlZXJyb3JPdXRwdXQlIiA+TlVMIDI+JjENCkdPVE8gQ0xFQU5VUA0KDQo6U1VDQ0VFREVEDQplY2hvIEZpbmlzaGVkIHBlcmZvcm1pbmcgb25ib2FyZGluZyBvcGVyYXRpb25zID5OVUwgMj4mMQ0KZWNoby4gPk5VTCAyPiYxDQpHT1RPIFdBSVRfRk9SX1RIRV9TRVJWSUNFX1RPX1NUQVJUDQoNCjpXQUlUX0ZPUl9USEVfU0VSVklDRV9UT19TVEFSVA0KZWNobyBXYWl0aW5nIGZvciB0aGUgc2VydmljZSB0byBzdGFydCA+TlVMIDI+JjENCmVjaG8uID5OVUwgMj4mMQ0KDQpzZXQgL2EgY291bnRlcj0wDQoNCjpTRU5TRV9SVU5OSU5HX1dBSVQNCnNjIHF1ZXJ5ICJTRU5TRSIgfCBmaW5kIC9pICJSVU5OSU5HIiA+TlVMIDI+JjENCmlmICVFUlJPUkxFVkVMJSBORVEgMCAoDQoJSUYgJWNvdW50ZXIlIEVRVSA0ICgNCgkJc2V0ICJlcnJvckRlc2NyaXB0aW9uPVVuYWJsZSB0byBzdGFydCBNaWNyb3NvZnQgRGVmZW5kZXIgZm9yIEVuZHBvaW50IFNlcnZpY2UuIg0KCQlzZXQgZXJyb3JDb2RlPTE1DQoJCXNldCBsYXN0RXJyb3I9JUVSUk9STEVWRUwlDQoJCUdPVE8gRVJST1INCgkpDQoNCglzZXQgL2EgY291bnRlcj0lY291bnRlciUrMQ0KDQoJdGltZW91dCA1ID5OVUwgMj4mMQ0KCUdPVE8gOlNFTlNFX1JVTk5JTkdfV0FJVA0KKQ0KDQpzZXQgL2EgY291bnRlcj0wDQoNCjpTRU5TRV9PTkJPQVJERURfU1RBVFVTX1dBSVQNClJFRyBxdWVyeSAiSEtMTVxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBBZHZhbmNlZCBUaHJlYXQgUHJvdGVjdGlvblxTdGF0dXMiIC92IE9uYm9hcmRpbmdTdGF0ZSAvcmVnOjY0ID5OVUwgMj4mMQ0KaWYgJUVSUk9STEVWRUwlIE5FUSAwICgNCglJRiAlY291bnRlciUgRVFVIDQgKA0KCQlAZWNobyBNaWNyb3NvZnQgRGVmZW5kZXIgZm9yIEVuZHBvaW50IFNlcnZpY2UgaXMgbm90IHJ1bm5pbmcgYXMgZXhwZWN0ZWQ+ICVUTVAlXHNlbnNlVG1wLnR4dA0KCQlzZXQgZXJyb3JDb2RlPTM1DQogICAgIHNldCBsYXN0RXJyb3I9JUVSUk9STEVWRUwlDQoJCUdPVE8gRVJST1INCgkpDQoNCglzZXQgL2EgY291bnRlcj0lY291bnRlciUrMQ0KDQoJdGltZW91dCA1ID5OVUwgMj4mMQ0KCUdPVE8gOlNFTlNFX09OQk9BUkRFRF9TVEFUVVNfV0FJVA0KKQ0KDQpzZXQgL2EgY291bnRlcj0wDQoNCjpTRU5TRV9PTkJPQVJERURfV0FJVA0KUkVHIHF1ZXJ5ICJIS0xNXFNPRlRXQVJFXE1pY3Jvc29mdFxXaW5kb3dzIEFkdmFuY2VkIFRocmVhdCBQcm90ZWN0aW9uXFN0YXR1cyIgL3YgT25ib2FyZGluZ1N0YXRlIC9yZWc6NjQgfCBmaW5kIC9pICIweDEiID5OVUwgMj4mMQ0KaWYgJUVSUk9STEVWRUwlIE5FUSAwICgNCglJRiAlY291bnRlciUgRVFVIDQgKA0KCQlAZWNobyBNaWNyb3NvZnQgRGVmZW5kZXIgZm9yIEVuZHBvaW50IFNlcnZpY2UgaXMgbm90IHJ1bm5pbmcgYXMgZXhwZWN0ZWQ+ICVUTVAlXHNlbnNlVG1wLnR4dA0KCQlzZXQgZXJyb3JDb2RlPTQwDQogICAgIHNldCBsYXN0RXJyb3I9JUVSUk9STEVWRUwlDQoJCUdPVE8gRVJST1INCgkpDQoNCglzZXQgL2EgY291bnRlcj0lY291bnRlciUrMQ0KDQoJdGltZW91dCA1ID5OVUwgMj4mMQ0KCUdPVE8gOlNFTlNFX09OQk9BUkRFRF9XQUlUDQopDQoNCnNldCAic3VjY2Vzc091dHB1dD1TdWNjZXNzZnVsbHkgb25ib2FyZGVkIG1hY2hpbmUgdG8gTWljcm9zb2Z0IERlZmVuZGVyIGZvciBFbmRwb2ludCINCmVjaG8gJXN1Y2Nlc3NPdXRwdXQlID5OVUwgMj4mMQ0KZWNoby4NCmV2ZW50Y3JlYXRlIC9sIEFwcGxpY2F0aW9uIC9zbyBXREFUUE9uYm9hcmRpbmcgL3QgSW5mb3JtYXRpb24gL2lkIDIwIC9kICIlc3VjY2Vzc091dHB1dCUiID5OVUwgMj4mMQ0KJXBvd2Vyc2hlbGxQYXRoJSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtTm9Qcm9maWxlIC1Db21tYW5kICJBZGQtVHlwZSAndXNpbmcgU3lzdGVtOyB1c2luZyBTeXN0ZW0uRGlhZ25vc3RpY3M7IHVzaW5nIFN5c3RlbS5EaWFnbm9zdGljcy5UcmFjaW5nOyBuYW1lc3BhY2UgU2Vuc2UgeyBbRXZlbnREYXRhKE5hbWUgPSBcIk9uYm9hcmRpbmdcIildcHVibGljIHN0cnVjdCBPbmJvYXJkaW5ne3B1YmxpYyBzdHJpbmcgTWVzc2FnZSB7IGdldDsgc2V0OyB9fSBwdWJsaWMgY2xhc3MgVHJhY2Uge3B1YmxpYyBzdGF0aWMgRXZlbnRTb3VyY2VPcHRpb25zIFRlbGVtZXRyeUNyaXRpY2FsT3B0aW9uID0gbmV3IEV2ZW50U291cmNlT3B0aW9ucygpe0xldmVsID0gRXZlbnRMZXZlbC5JbmZvcm1hdGlvbmFsLCBLZXl3b3JkcyA9IChFdmVudEtleXdvcmRzKTB4MDAwMDIwMDAwMDAwMDAwMCwgVGFncyA9IChFdmVudFRhZ3MpMHgwMjAwMDAwfTsgcHVibGljIHZvaWQgV3JpdGVPbmJvYXJkaW5nTWVzc2FnZShzdHJpbmcgbWVzc2FnZSl7ZXMuV3JpdGUoXCJPbmJvYXJkaW5nU2NyaXB0XCIsIFRlbGVtZXRyeUNyaXRpY2FsT3B0aW9uLCBuZXcgT25ib2FyZGluZyB7TWVzc2FnZSA9IG1lc3NhZ2V9KTt9IHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IHN0cmluZ1tdIHRlbGVtZXRyeVRyYWl0cyA9IHsgXCJFVFdfR1JPVVBcIiwgXCJ7NUVDQjBCQUMtQjkzMC00N0Y1LUE4QTQtRTgyNTM1MjlFREI3fVwiIH07IHByaXZhdGUgRXZlbnRTb3VyY2UgZXMgPSBuZXcgRXZlbnRTb3VyY2UoXCJNaWNyb3NvZnQuV2luZG93cy5TZW5zZS5DbGllbnQuTWFuYWdlbWVudFwiLEV2ZW50U291cmNlU2V0dGluZ3MuRXR3U2VsZkRlc2NyaWJpbmdFdmVudEZvcm1hdCx0ZWxlbWV0cnlUcmFpdHMpO319JzsgJGxvZ2dlciA9IE5ldy1PYmplY3QgLVR5cGVOYW1lIFNlbnNlLlRyYWNlOyAkbG9nZ2VyLldyaXRlT25ib2FyZGluZ01lc3NhZ2UoJyVzdWNjZXNzT3V0cHV0JScpIiA+TlVMIDI+JjENCiIlUFJPR1JBTUZJTEVTJVxXaW5kb3dzIERlZmVuZGVyXE1wQ21kUnVuLmV4ZSIgLVJlbG9hZEVuZ2luZSA+TlVMIDI+JjENCg0KR09UTyBDTEVBTlVQDQoNCjpDTEVBTlVQDQppZiBleGlzdCAlVE1QJVxzZW5zZVRtcC50eHQgZGVsICVUTVAlXHNlbnNlVG1wLnR4dA0KRVhJVCAvQiAlZXJyb3JDb2RlJQ0KCg=="
                            }
                          }
                        }
                      ],
                      "outputs": {
                        "policy": {
                          "type": "string",
                          "value": "[concat('Enabled extension for: ', parameters('vmName'))]"
                        }
                      }
                    },
                    "parameters": {
                      "vmName": {
                        "type": "[field('name')]"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
